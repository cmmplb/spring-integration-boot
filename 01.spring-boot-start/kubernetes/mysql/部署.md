创建mysql

kubectl apply -f mysql-deployment.yaml

kubectl get deployments

其他Pod可以通过服务名称访问MySQL，需要创建Service，添加配置文件mysql-service.yaml用于创建Service；

通过应用配置文件来创建Service；
kubectl apply -f mysql-service.yaml 

kubectl get services

添加配置文件mall-tiny-fabric-deployment.yaml用于创建Deployment，这里我们可以通过环境变量来覆盖SpringBoot中的默认配置；

应用配置文件来创建Deployment；

kubectl apply -f mall-tiny-fabric-deployment.yaml

kubectl get pods

查看日志
kubectl logs -f mall-tiny-fabric-deployment-8684857dff-pnz2t

如果想要从外部访问SpringBoot应用，需要创建Service，添加配置文件mall-tiny-fabric-service.yaml用于创建Service；


通过应用配置文件来创建Service；
kubectl apply -f mall-tiny-fabric-service.yaml

安装完成后添加一个Nginx的配置文件，这里我的配置路径为/mydata/nginx/conf/conf.d/，用于将mall-tiny.macrozheng.com域名的访问代理到K8S中的SpringBoot应用中去，proxy_pass为上面curl使用的路径；
server {
listen       80;
server_name  mall-tiny.macrozheng.com; #修改域名

    location / {
        proxy_set_header Host $host:$server_port;
        proxy_pass   http://192.168.49.2:30180; #修改为代理服务地址
        index  index.html index.htm;
    }

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

}

重启Nginx服务，再修改访问Linux服务器的本机host文件，添加如下记录；
192.168.5.94 mall-tiny.macrozheng.com

之后即可直接在本机上访问K8S上的SpringBoot应用了，访问地址：http://mall-tiny.macrozheng.com/swagger-ui.html




